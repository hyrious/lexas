<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>MDP Robot</title>
  <style>
    body {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      -o-user-select: none;
      user-select: none;
      margin: 2em 2.5em;
    }
    body * {
      box-sizing: border-box;
    }
    a {
      color: inherit;
      text-decoration: none;
      border: 2px solid transparent;
    }
    a:hover {
      border: 2px solid #ccc;
    }
    a:active {
      color: #fcc;
    }
    button,h1 {
      margin: 0;
      border: none;
      padding: 0 .1em 0 0;
      background: none;
      font-size: 5em;
      font-weight: normal;
      font-variant: small-caps;
      font-family: Consolas, monospace;
    }
    .action:hover {
      outline: 2px solid #666;
    }
    .action:active {
      background-color: #333;
      color: #fff;
    }
    .action:focus {
      outline: 2px solid #ccc;
    }
    table {
      border-collapse: collapse;
      font-family: monospace;
    }
    td {
      min-width: 14.5ch;
    }
    .title {
      font-family: Serif;
      font-weight: normal;
      font-size: 1.2em;
      color: #911;
      border-bottom: 2px solid #fcc;
    }
    .title>td {
      padding-top: 1em;
    }
    td span:nth-child(odd) {
      padding-left: 1em;
      border-right: .2em solid transparent;
    }
    td span:nth-child(even) {
      border-left: .2em solid transparent;
      padding-right: 1em;
    }
    .policy {
      background-color: #ccc;
    }
    .policy td {
      text-align: center;
    }
    .adjust {
      background-color: #fcc;
      color: red;
    }
    .ans {
      background-color: initial;
      outline: 2px solid red;
    }
  </style>
</head>
<body style="transition:opacity .3s ease">
  <div id="s1">
    <input type="file" id="ef" style="display:none">
    <button id="ei" class="action" style="display:none">I<span id="e1" style="opacity:0;transition:opacity .4s ease-out">nput</span></button>
    <div id="first" style="opacity:0;transition:opacity .3s ease-out">
      <pre><code>a <span style="color:#33f"><a href="mdp.txt">file.txt</a></span> generated by <span style="color:#f33"><a href="mdp.py">mdp.py</a></span> here.
It looks like:</code></pre>
      <pre style="display:inline"><code>Certain Value Iteration :
0.000|0.000 0.000|0.000 0.000|0.000 0.000|0.000 0.000|0.000 0.000|0.000
0.000|0.000 1.000|0.000 0.500|0.000 0.250|0.000 0.125|5.000 0.000|0.000
0.000|0.000 1.000|0.250 0.500|0.125 0.250|2.500 1.250|5.000 0.000|0.000
0.000|0.000 1.000|0.250 0.500|1.250 0.625|2.500 1.250|5.000 0.000|0.000
0.000|0.000 1.000|0.625 0.500|1.250 0.625|2.500 1.250|5.000 0.000|0.000
     *           <           >           >           >           *     
-----------------------------------------------------------------------
Certain Policy Iteration :
     *           >           >           >           >           *     
0.000|0.000 0.000|0.000 0.000|0.000 0.000|0.000 0.000|0.000 0.000|0.000
0.000|0.000 1.000|0.000 0.000|0.000 0.000|0.000 0.000|5.000 0.000|0.000
0.000|0.000 1.000|0.000 0.000|0.000 0.000|2.500 1.250|5.000 0.000|0.000
0.000|0.000 1.000|0.000 0.000|1.250 0.625|2.500 1.250|5.000 0.000|0.000
0.000|0.000 1.000|0.625 0.312|1.250 0.625|2.500 1.250|5.000 0.000|0.000
     *           <           >           >           >           *     
...</code></pre>
    </div>
  </div>
  <div id="s2" style="display:none">
    <h1 id="R" style="display:none">R<span id="Re" style="opacity:0;transition:opacity .4s ease-out">esult</span></h1>
    <div id="second" style="opacity:0;transition:opacity .3s ease-out"></div>
  </div>
  <script>
    window.onload = function(){
      var g = document.getElementById.bind(document);
      var c = document.createElement.bind(document);
      var a = Object.assign.bind(Object);
      function animeIn(a, b, c){
        window.setTimeout(function(){
          g(a).style.display = 'block';
          window.setTimeout(function(){
            g(b).style.opacity = 1;
            window.setTimeout(function(){
              g(c).style.opacity = 1;
            }, 200);
          }, 280);
        }, 330);
      }
      function next(str){
        g('s1').style.display = 'none';
        var s = g('second');
        while (s.firstChild)
          s.removeChild(firstChild);
        var seq = str.split('\n');
        var b = c('table');
        var ps;
        for (var i in seq) {
          if (seq[i][0] == 'C' || seq[i][0] == 'U') {
            var tr = a(c('tr'), { className: 'title' });
            tr.appendChild(a(c('td'), { innerText: seq[i], colSpan: '6' }));
            b.appendChild(tr);
          }
          if (seq[i][0] == '0') {
            var tr = c('tr');
            seq[i].split(' ').forEach(function(e){
              var td = c('td');
              e.split('|').forEach(function(n){
                td.appendChild(a(c('span'), { innerText: n }));
              });
              tr.appendChild(td);
            });
            b.appendChild(tr);
          }
          if (seq[i][0] == ' ') {
            var tr = a(c('tr'), { className: 'policy' });
            var s = seq[i].split(/\s+/);
            var k = 0;
            if (ps && ps.join('') != s.join('')) {
              for (; ps[k] == s[k]; k++)
                ;
            }
            for (var j = 1; j <= 6; j++) {
              var td = a(c('td'), { innerText: s[j] });
              if (j == k) td = a(td, { className: 'adjust' });
              tr.appendChild(td);
            }
            ps = s;
            b.appendChild(tr);
          }
        }
        var tr;
        for (var i in b.childNodes) {
          if (tr && tr.className == 'policy' && b.childNodes[i].className == 'title') {
            tr.className += ' ans';
          }
          tr = b.childNodes[i];
        }
        tr.className += ' ans';
        g('s2').style.display = 'block';
        g('second').appendChild(b);
        animeIn('R', 'Re', 'second');
      }
      function loadFile(file){
        if (!file) return;
        var reader = new FileReader();
        reader.onload = function(e){
          var content = e.target.result;
          next(content);
        };
        reader.readAsText(file);
      }
      g('ei').onclick = function(e){
        g('ef').click();
      };
      g('ef').onchange = function(e){
        loadFile(e.target.files[0]);
      };
      animeIn('ei', 'e1', 'first');
      document.body.addEventListener('dragover', function(e){
        e.preventDefault();
        document.body.style.opacity = .4;
      });
      document.body.addEventListener('drop', function(e){
        e.preventDefault();
        document.body.style.opacity = 1;
        loadFile(e.dataTransfer.files[0]);
      });
      document.body.addEventListener('dragend', function(e){
        e.preventDefault();
        e.dataTransfer.clearData();
      });
    };
  </script>
</body>
</html>